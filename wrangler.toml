name = "alphaarena-live"
compatibility_date = "2024-09-23"
workers_dev = true

# OpenNext Cloudflare worker output
main = ".open-next/worker.js"

# Required for Next.js SSR and Node.js APIs (Prisma, Supabase, etc.)
compatibility_flags = ["nodejs_compat"]

# Static assets
[assets]
directory = ".open-next/assets"
binding = "ASSETS"

# Limits
limits = { cpu_ms = 50000 }

# Environment variables
[vars]
NODE_ENV = "production"
NEXT_PUBLIC_APP_URL = "https://www.alphaarena-live.com"

# Note: NEXT_PUBLIC_* variables are public and safe to commit
# Add your Supabase public values here:
# NEXT_PUBLIC_SUPABASE_URL = "your_supabase_url"
# NEXT_PUBLIC_SUPABASE_ANON_KEY = "your_anon_key"

# Sensitive secrets (already set via wrangler secret put):
# - SUPABASE_SERVICE_ROLE_KEY
# - OPENROUTER_API_KEY
# - CRON_SECRET
# - NEXT_PUBLIC_SUPABASE_URL (set as secret for now)
# - NEXT_PUBLIC_SUPABASE_ANON_KEY (set as secret for now)

# Cloudflare D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "alphaarena-db"
database_id = "ba3f55eb-c8b1-4195-b685-5bef374f083a"

# Cron triggers for data synchronization
[triggers]
crons = ["*/5 * * * *"]  # Every 5 minutes: sync real-time data
